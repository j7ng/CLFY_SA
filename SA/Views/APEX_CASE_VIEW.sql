CREATE OR REPLACE FORCE VIEW sa.apex_case_view (q_objid,id_number,title,age,carrier_id,carrier_name,esn,"CONDITION",status,"PRIORITY",severity,creation_time) AS
select /*+ FIRST_ROWS(250) */
        c.case_currq2queue q_objid,
        c.id_number,
        c.title,
        con.queue_time "AGE",
        c.x_text_car_id "CARRIER_ID",
        c.x_carrier_name "CARRIER_NAME",
        c.x_esn "ESN",
        con.title "CONDITION",
        decode(c.casests2gbst_elm,
               '268435557','Low',
               '268435559','High',
               '268435563','Low',
               '268435565','High',
               '268435567','Problem',
               '268435570','CR',
               '268435577','Solving',
               '268435578','Closed',
               '268435579','Not Started',
               '268435580','In Progress',
               '268435583','Completed',
               '268435592','Default',
               '268435957','Isolated',
               '268436056','Pending',
               '268436057','Carri Problem Solved',
               '268436058','Tech Problem Solved',
               '268436905','Shipped',
               '268436906','Shipped',
               '268436907','Received',
               '268436956','Open',
               '268437071','Address Updated',
               '268437072','Bad Address',
               '268437073','Exception',
               '268437074','BadAddress',
               '268437082','Escalated',
               '268437086','Received',
               '268437088','Accessory Released',
               '268437089','Exception Released',
               '268437090','Expired',
               '268438203','Pending Approval',
               '268438206','Rework',
               '268438209','Pending Credit',
               '536873668','ESN Received',
               c.casests2gbst_elm) "STATUS",
        decode(c.respprty2gbst_elm,
               '268435557','Low',
               '268435558','Medium',
               '268435559','High',
               '268435563','Low',
               '268435564','Medium',
               '268435565','High',
               '268435567','Problem',
               '268435592','Default',
               '268436056','Pending',
               '268436057','Carri Problem Solved',
               '268436905','Shipped',
               '268435556', 'Communication',
               '268435560', 'Urgent',
               c.respprty2gbst_elm) "PRIORITY",
        decode(c.respsvrty2gbst_elm,
               '268435557','Low',
               '268435559','High',
               '268435562','No Rush',
               '268435563','Low',
               '268435564','Medium',
               '268435565','High',
               '268435566','Urgent',
               '268435567','Problem',
               '268435592','Default',
               '268436056','Pending',
               c.respsvrty2gbst_elm) "SEVERITY",
        to_char(c.creation_time, 'MM/DD/YYYY HH:MI:SS PM') creation_time
 from   table_case c,
        table_condition con
 where  1=1
 and    c.case_state2condition = con.objid
 and    c.case_owner2user is not null
 and    con.title != 'CLOSED';