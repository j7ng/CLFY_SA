CREATE OR REPLACE PROCEDURE sa.CREATE_DBLINK(P_ENV IN VARCHAR2) IS

V_LINK_CNT NUMBER :=0;

BEGIN

SELECT COUNT(*)
INTO V_LINK_CNT
FROM ALL_DB_LINKS
WHERE DB_LINK='OFSPRD.WORLD' AND OWNER='SA';

IF V_LINK_CNT > 0 THEN
EXECUTE IMMEDIATE 'DROP DATABASE LINK OFSPRD';
END IF;

CASE P_ENV
WHEN 'OFSDEV' THEN
     EXECUTE IMMEDIATE 'CREATE DATABASE LINK "OFSPRD.WORLD"
     CONNECT TO "TF" IDENTIFIED BY VALUES '||'''06ED50B16C892D881FF8639BF0C4D795DBF1BA8290318F76996D22DE1CEFA473E63F49FC927D135F00191FBFBB487BFD064E52C99DB1BE82039C5A1841E5C824815EF817D167574C73C51D0EE41E6DF83CB7DD2B9D64FAA6F1973F64C968780B9148B71A7D55C29F461B5C1D51D10E556CDE0ACC697B1E2CE50557CFE79C292E'''||
     ' USING '||'''(DESCRIPTION = (ADDRESS_LIST = (ADDRESS = (PROTOCOL = TCP)(HOST = dsvmofs.tracfone.com)(PORT = 1526))) (CONNECT_DATA = (SID = OFSDEV) (SERVER = DEDICATED)))''';
WHEN 'OFSSIT' THEN
    EXECUTE IMMEDIATE 'CREATE DATABASE LINK "OFSPRD.WORLD"
    CONNECT TO "TF" IDENTIFIED BY VALUES '||'''068D127669FF235C1BEE4F8F3CEEF07590D28B4522EC847E015E80FDBAA9D260B69D404A7504F32F69D3A9305D832FB1EECE28ACD15D71C2144F12C7B9A69601F5627FFAB15E9AC785D2FDCB3C996BA528E968E61EDC86621CDC862FBF48892AF6CF479F3A576BA275C208B77FD14A8316DFBC20CFB9A36DFEB6CD34ADDE5472'''||
    ' USING '||'''(DESCRIPTION = (ADDRESS_LIST = (ADDRESS = (PROTOCOL = TCP)(HOST = dsvmofs.tracfone.com)(PORT = 1531))) (CONNECT_DATA = (SID = OFSSIT) (SERVER = DEDICATED)))''';
END CASE;
END;
/